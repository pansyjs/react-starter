import{r as A,j as I,R as q,a as W}from"./index-c6428e0c.js";var f;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(f||(f={}));var Q={key:"f97efc35164149d0c0f299e7a8adb3d2",AMap:{version:"2.0",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"2.0.0"}};function V(e){return"https://webapi.amap.com/maps?callback=__amap_init_callback"+"&v=".concat(e.AMap.version)+"&key=".concat(e.key)+"&plugin=".concat(e.AMap.plugins.join(","))}function k(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function X(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?k(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var v={AMap:f.notload,AMapUI:f.notload,Loca:f.notload},U={AMap:[],AMapUI:[],Loca:[]},c=X({},Q),D=[];function ee(e){if(typeof e=="function"){if(v.AMap===f.loaded){e(window.AMap);return}D.push(e)}}function x(e){var n=[];return e.AMapUI&&n.push(ne(e.AMapUI)),e.Loca&&n.push(re(e.Loca)),Promise.all(n)}function ne(e){return new Promise(function(n,r){var t=[];if(e.plugins)for(var a=0;a<e.plugins.length;a+=1)c.AMapUI.plugins.indexOf(e.plugins[a])==-1&&t.push(e.plugins[a]);if(v.AMapUI===f.failed){r("前次请求 AMapUI 失败");return}if(v.AMapUI===f.notload){v.AMapUI=f.loading,c.AMapUI.version=e.version||c.AMapUI.version;var i=c.AMapUI.version,s=document.body||document.head,u=document.createElement("script");u.type="text/javascript",u.src="https://webapi.amap.com/ui/".concat(i,"/main.js"),u.onerror=function(o){v.AMapUI=f.failed,r("请求 AMapUI 失败")},u.onload=function(){if(v.AMapUI=f.loaded,t.length)window.AMapUI.loadUI(t,function(){for(var o=0,d=t.length;o<d;o++){var g=t[o],h=g.split("/").slice(-1)[0];window.AMapUI[h]=arguments[o]}for(n();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()});else for(n();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()},s.appendChild(u);return}if(v.AMapUI===f.loaded){e.version&&e.version!==c.AMapUI.version?r("不允许多个版本 AMapUI 混用"):t.length?window.AMapUI.loadUI(t,function(){for(var o=0,d=t.length;o<d;o++){var g=t[o],h=g.split("/").slice(-1)[0];window.AMapUI[h]=arguments[o]}n()}):n();return}e.version&&e.version!==c.AMapUI.version?r("不允许多个版本 AMapUI 混用"):U.AMapUI.push(function(o){o?r(o):t.length?window.AMapUI.loadUI(t,function(){for(var d=0,g=t.length;d<g;d++){var h=t[d],y=h.split("/").slice(-1)[0];window.AMapUI[y]=arguments[d]}n()}):n()})})}function re(e){return new Promise(function(n,r){if(v.Loca===f.failed){r("前次请求 Loca 失败");return}if(v.Loca===f.notload){v.Loca=f.loading,c.Loca.version=e.version||c.Loca.version;var t=c.Loca.version,a=c.AMap.version.startsWith("2"),i=t.startsWith("2");if(a&&!i||!a&&i){r("JSAPI 与 Loca 版本不对应！！");return}var s=c.key,u=document.body||document.head,o=document.createElement("script");o.type="text/javascript",o.src="https://webapi.amap.com/loca?v=".concat(t,"&key=").concat(s),o.onerror=function(){v.Loca=f.failed,r("请求 Loca 失败")},o.onload=function(){for(v.Loca=f.loaded,n();U.Loca.length;)U.Loca.splice(0,1)[0]()},u.appendChild(o);return}if(v.Loca===f.loaded){e.version&&e.version!==c.Loca.version?r("不允许多个版本 Loca 混用"):n();return}e.version&&e.version!==c.Loca.version?r("不允许多个版本 Loca 混用"):U.Loca.push(function(d){d?r(d):r()})})}function te(e){return new Promise(function(n,r){if(v.AMap==f.failed){r();return}if(v.AMap==f.notload){var t=e.key,a=t===void 0?c.key:t,i=e.version,s=i===void 0?c.AMap.version:i,u=e.plugins,o=u===void 0?[]:u;c.key=a,c.AMap.version=s,c.AMap.plugins=o,v.AMap=f.loading;var d=document.body||document.head;window.__amap_init_callback=function(l){if(delete window.__amap_init_callback,l){v.AMap=f.failed,r(l);return}for(v.AMap=f.loaded,x(e).then(function(){n(window.AMap)}).catch(r);D.length;)D.splice(0,1)[0]()};var g=document.createElement("script");g.type="text/javascript",g.src=V(c),g.onerror=function(l){v.AMap=f.failed,r(l)},d.appendChild(g);return}if(v.AMap==f.loaded){if(e.key&&e.key!==c.key){r("多个不一致的 key");return}if(e.version&&e.version!==c.AMap.version){r("不允许多个版本 JSAPI 混用");return}var h=[];if(e.plugins)for(var y=0;y<e.plugins.length;y+=1)c.AMap.plugins.indexOf(e.plugins[y])==-1&&h.push(e.plugins[y]);h.length?window.AMap.plugin(h,function(){x(e).then(function(){n(window.AMap)}).catch(r)}):x(e).then(function(){n(window.AMap)}).catch(r);return}if(e.key&&e.key!==c.key){r("多个不一致的 key");return}if(e.version&&e.version!==c.AMap.version){r("不允许多个版本 JSAPI 混用");return}var b=[];if(e.plugins)for(var y=0;y<e.plugins.length;y+=1)c.AMap.plugins.indexOf(e.plugins[y])==-1&&b.push(e.plugins[y]);ee(function(){b.length?window.AMap.plugin(b,function(){x(e).then(function(){n(window.AMap)}).catch(r)}):x(e).then(function(){n(window.AMap)}).catch(r)})})}var ae=typeof window<"u",ie=function(n){return n[0].toUpperCase()+n.slice(1,n.length)},T=function(){return window.AMap||window.proxy.AMap},oe=function(n){if(!n)return null;if("getLng"in n&&"getLat"in n)return n;var r=0,t=0;Array.isArray(n)?(r=n[0],t=n[1]):"lng"in n&&"lat"in n?(r=n.lng,t=n.lat):"longitude"in n&&"latitude"in n&&(r=n.longitude,t=n.latitude);var a=T();return ae&&a?new a.LngLat(r,t):null};function ue(e,n){var r=A.useRef(),t=A.useRef(),a=typeof n=="function"?n(t.current,e):!0;return a&&(r.current=t.current,t.current=e),r.current}function le(e,n){return de(e)||se(e,n)||fe(e,n)||ce()}function ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fe(e,n){if(e){if(typeof e=="string")return z(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,n)}}function z(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function se(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var t=[],a=!0,i=!1,s,u;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(t.push(s.value),!(n&&t.length===n));a=!0);}catch(o){i=!0,u=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw u}}return t}}function de(e){if(Array.isArray(e))return e}function pe(e,n){var r,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=t.setterMap,i=a===void 0?{}:a,s=t.converterMap,u=s===void 0?{}:s,o=(r=ue(e))!==null&&r!==void 0?r:{},d=A.useRef([]),g=A.useState(!1),h=le(g,2),y=h[0],b=h[1];A.useEffect(function(){n.current&&p(e,!0)},[e]),A.useEffect(function(){return function(){if(n.current)try{"destroy"in n.current&&n.current.destroy(),"hide"in n.current&&n.current.hide(),"map"in e&&"setMap"in n.current&&n.current.setMap(null)}catch{}}},[]);var l=function(m){if(b(!0),"events"in e&&m){var P,O;(P=(O=e.events).created)===null||P===void 0||P.call(O,m)}p(e,!1)},p=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,O=n.current;if(O)try{Object.keys(m).forEach(function(M){if(M==="events")return S(m);var C=!0;if(P&&(C=_(M,m,o)),!!C){var j=m[M];if(M in u&&(j=u[M](m[M])),M in i)i[M](j,O);else{var L="set".concat(ie(M));L in O&&O[L](j)}}})}catch{}},S=function(m){var P=n.current,O=Object.keys(m.events||{});O.length&&O.forEach(function(M){d.current.indexOf(M)===-1&&(d.current.push(M),P.on(M,function(C){return function(){if(m.events&&C in m.events){for(var j=arguments.length,L=new Array(j),E=0;E<j;E++)L[E]=arguments[E];m.events[C].apply(null,L)}}}(M)))})},_=function(m,P,O){return P[m]!==O[m]};return{loaded:y,prevProps:o,onInstanceCreated:l}}var ve=["loading","children","onComplete"];function K(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?K(Object(r),!0).forEach(function(t){ge(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ge(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function B(e,n){return me(e)||be(e,n)||ye(e,n)||he()}function he(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ye(e,n){if(e){if(typeof e=="string")return H(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,n)}}function H(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function be(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var t=[],a=!0,i=!1,s,u;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(t.push(s.value),!(n&&t.length===n));a=!0);}catch(o){i=!0,u=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw u}}return t}}function me(e){if(Array.isArray(e))return e}function Ae(e,n){if(e==null)return{};var r=Me(e,n),t,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function Me(e,n){if(e==null)return{};var r={},t=Object.keys(e),a,i;for(i=0;i<t.length;i++)a=t[i],!(n.indexOf(a)>=0)&&(r[a]=e[a]);return r}var we=function(n){var r=n.loading,t=n.children,a=n.onComplete,i=Ae(n,ve),s=A.useState(!1),u=B(s,2),o=u[0],d=u[1],g=A.useState(!0),h=B(g,2),y=h[0],b=h[1];return A.useEffect(function(){te(R(R({},i),{},{key:i.mapKey})).then(function(){var l=T();a==null||a(l),d(!0),b(!1)}).catch(function(l){b(!1)})},[JSON.stringify(i)]),y&&r?I.jsx(I.Fragment,{children:r}):I.jsx(I.Fragment,{children:o&&t})},Oe=["layers","zoom","zooms","center","labelzIndex","lang","mapStyle","features","cursor","pitch","mask","defaultLayer"],G=["animateEnable","doubleClickZoom","dragEnable","isHotspot","jogEnable","keyboardEnable","pitchEnable","resizeEnable","rotateEnable","scrollWheel","touchZoom","zoomEnable"],Ie=["view","showIndoorMap","indoorMap","expandZoomRange","touchZoomCenter","showBuildingBlock","viewMode","buildingAnimation","skyColor"],Pe={width:"100%",height:"100%",position:"relative"},Se={width:"100%",height:"100%"},Ue=Oe.concat(G,Ie),_e={zoom:function(n,r){r&&r.setZoom(n)},cursor:function(n,r){r&&r.setDefaultCursor(n)},labelzIndex:function(n,r){r&&r.setLabelzIndex(n)}},$={center:oe,mapStyle:function(n){return n.indexOf("amap://styles")===0?n:"amap://styles/".concat(n)}},je=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=A.useRef(),t=A.useRef(),a=pe(n,t,{setterMap:_e,converterMap:$}),i=a.loaded,s=a.prevProps,u=a.onInstanceCreated;A.useEffect(function(){o().then(function(){var b;(b=n.onMapCreate)===null||b===void 0||b.call(n,t.current),u==null||u(t.current)})},[]),A.useEffect(function(){i&&h(s,n)},[n]);var o=function(){var l=d(),p=T();return t.current=new p.Map(r.current,l),Promise.resolve()},d=function(){var l={};return Ue.forEach(function(p){p in n&&(l[p]=g(p,n))}),l},g=function(l,p){return l in $?$[l](p[l]):p[l]},h=function(l,p){var S={},_=!1;G.forEach(function(w){w in p&&y(w,l,p)&&(_=!0,S[w]=p[w])}),_&&t.current.setStatus(S)},y=function(l,p,S){return p[l]!==S[l]};return I.jsxs("div",{style:Pe,children:[I.jsx("div",{ref:r,style:Se,children:i?null:n.loading}),I.jsx("div",{children:i?n.children:null})]})},Ce=q.createContext({}),Le=["mapKey","version","plugins","AMapUI","Loca","loading","onMapCreate"];function Z(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function J(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Z(Object(r),!0).forEach(function(t){xe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xe(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function F(e,n){return Te(e)||De(e,n)||$e(e,n)||Ee()}function Ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $e(e,n){if(e){if(typeof e=="string")return N(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,n)}}function N(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function De(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var t=[],a=!0,i=!1,s,u;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(t.push(s.value),!(n&&t.length===n));a=!0);}catch(o){i=!0,u=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw u}}return t}}function Te(e){if(Array.isArray(e))return e}function We(e,n){if(e==null)return{};var r=ke(e,n),t,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function ke(e,n){if(e==null)return{};var r={},t=Object.keys(e),a,i;for(i=0;i<t.length;i++)a=t[i],!(n.indexOf(a)>=0)&&(r[a]=e[a]);return r}var ze=q.forwardRef(function(e,n){var r=e.mapKey,t=e.version,a=e.plugins,i=e.AMapUI,s=e.Loca,u=e.loading;e.onMapCreate;var o=We(e,Le),d=A.useState(),g=F(d,2),h=g[0],y=g[1],b=A.useState(),l=F(b,2),p=l[0],S=l[1];return A.useImperativeHandle(n,function(){return p},[p]),I.jsx(Ce.Provider,{value:{AMap:h,map:p},children:I.jsx(we,{mapKey:r,version:t,plugins:a,Loca:s,AMapUI:i,loading:u,onComplete:function(w){y(w)},children:I.jsx(je,J(J({loading:u},o),{},{onMapCreate:function(w){S(w)}}))})})});const Re=()=>W("div",{style:{height:"100vh"},children:W(ze,{})});export{Re as default};
